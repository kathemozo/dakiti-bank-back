(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[361],{7899:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/usuarios",function(){return r(6290)}])},6290:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return U}});var o=r(4051),t=r.n(o),i=r(5893),a=r(7294),s=r(4416),l=r(3832),c=r(282),d=r(649),u=r(2430),p=r(6945),m=r(7590),h=r(5988),f=r(2280),b=r(7821),x=r(1423),v=r(1749),g=r(6455);function j(e){var n=e.valoresPermisos,r=e.handleChangePermisos;return(0,i.jsx)("div",{id:"Checkbox-scroll",children:(0,i.jsxs)(v.Z,{container:!0,id:"contenedor-lista-permisos",children:[(0,i.jsxs)(v.Z,{xs:12,children:[(0,i.jsx)(c.Z,{onClick:console.log("algo"),className:"small-button red-background add-button",children:"Deseleccionar todos"}),(0,i.jsx)(c.Z,{onClick:console.log("algo"),className:"small-button blue-background add-button",variant:"contained",children:"Seleccionar todos"})]}),Object.keys(n).map((function(e){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("label",{children:[e,":"]}),(0,i.jsx)(v.Z,{xs:12,container:!0,className:"los-permisos",children:("usuarios"===e?["leer","escribir","modificar","eliminar","todos"]:["leer"]).map((function(o){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("input",{checked:n[e][o],disabled:"leer"!==o&&!n[e].leer&&"todos"!=o,onChange:function(n){r(e,o,n.target.checked)},type:"checkbox"}),o]})}))})]})}))]})})}var y=new String("#contenedor-lista-permisos button{position:relative;\nleft:calc(50% - 200px)!important;\ntext-transform:uppercase;\ncursor:pointer;\nwidth:200px;\n-webkit-transition:all ease .5s;\ntransition:all ease .5s}\n#contenedor-lista-permisos label{margin-left:10px;\nmargin-top:20px;\ntext-transform:capitalize}\n#contenedor-lista-permisos input{margin-left:40px;\nheight:15px;\nwidth:15px;\npadding:0px;\nmargin-top:3px;\nfont-size:30px}\n#contenedor-lista-permisos{overflow-x:auto;\nheight:250px}\n#contenedor-lista-permisos::-webkit-scrollbar{width:5px;\nheight:5px!important;\nbackground-color:rgba(255, 255, 255, 0.2)}\n#contenedor-lista-permisos::-webkit-scrollbar-thumb{background-color:rgba(0, 0, 0, 0.6)}\n.los-permisos{border-bottom:solid;\nborder-width:1px;\nborder-collapse:all;\ntext-transform:capitalize}");y.__hash="1fbc572b6063c5b4";var w=y;function k(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function C(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},o=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(n){k(e,n,r[n])}))}return e}var N=(0,s.$j)((function(e){return{user:e.user}}))((function(e){var n=e.open,r=e.handleClose,o=e.loading,t=e.handleSubmit,s=e.user,c=(0,a.useState)([]),d=c[0],u=(c[1],(0,a.useState)("")),p=(u[0],u[2],(0,a.useState)(0)),m=p[0],y=p[1],N=(0,a.useRef)(null),S=(0,a.useState)({usuarios:{leer:!0,escribir:!0,modificar:!0,eliminar:!0},dashboard:{leer:!0}}),_=S[0],Z=S[1];return(0,i.jsx)(f.Z,{open:n,handleClose:r,loading:o,handleSubmit:function(){y(0),setTimeout((function(){var e=new FormData(N.current);t(e,_)}),[20])},title:"Nuevo Usuario",height:500,width:800,children:(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(b.Z,{value:m,onChange:function(e,n){y(n)},indicatorColor:"primary",children:[(0,i.jsx)(x.Z,{label:"Detalles",value:0}),(0,i.jsx)(x.Z,{label:"Permisos",value:1})]}),0===m?(0,i.jsx)("form",{onSubmit:t,ref:N,className:"jsx-".concat(w.__hash),children:(0,i.jsxs)(v.Z,{container:!0,children:[(0,i.jsxs)(v.Z,{xs:6,children:[(0,i.jsx)(g.oi,{label:"Primer Nombre (*)",type:"text",placeholder:"Ingrese su primer nombre",name:"primerNombre",error:d.includes("primerNombre"),disabled:o}),(0,i.jsx)(g.oi,{label:"Segundo Nombre",type:"text",placeholder:"Ingrese su segundo nombre",name:"segundoNombre",disabled:o}),(0,i.jsx)(g.oi,{label:"Primer Apellido (*)",type:"text",placeholder:"Ingrese su primer apellido",name:"primerApellido",error:d.includes("primerApellido"),disabled:o}),(0,i.jsx)(g.oi,{label:"Segundo Apellido (*)",type:"text",placeholder:"Ingrese su segundo apellido",name:"segundoApellido",error:d.includes("segundoApellido"),disabled:o})]}),(0,i.jsxs)(v.Z,{xs:6,children:[(0,i.jsx)("div",{style:{display:"flex"},className:"jsx-".concat(w.__hash),children:(0,i.jsx)(g.oi,{label:"C\xe9dula (*)",type:"text",placeholder:"Ingrese su c\xe9dula",name:"identificador",error:d.includes("identificador"),disabled:o})}),(0,i.jsx)(g.oi,{label:"Correo Electr\xf3nico(*)",type:"text",placeholder:"Ingrese su correo electr\xf3nico",name:"email",error:d.includes("email"),disabled:o}),(0,i.jsx)(g.oi,{label:"Contrase\xf1a (*)",type:"password",placeholder:"Ingrese su contrase\xf1a",name:"password",error:d.includes("password"),disabled:o}),(0,i.jsx)(g.oi,{label:"Creado por (*)",type:"text",placeholder:"Ingrese su contrase\xf1a",name:"creadoPor",defaultValue:"".concat(null===s||void 0===s?void 0:s.primerNombre," ").concat(null===s||void 0===s?void 0:s.segundoNombre," ").concat(null===s||void 0===s?void 0:s.primerApellido," ").concat(null===s||void 0===s?void 0:s.segundoApellido),disabled:!0})]})]})}):(0,i.jsx)(j,{valoresPermisos:_,handleChangePermisos:function(e,n,r){Z(C({},_,k({},e,C({},_[e],k({},n,r)))))}}),(0,i.jsx)(h.default,{id:w.__hash,children:w})]})})}));function S(e,n,r,o,t,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?n(l):Promise.resolve(l).then(o,t)}function _(e){return function(){var n=this,r=arguments;return new Promise((function(o,t){var i=e.apply(n,r);function a(e){S(i,o,t,a,s,"next",e)}function s(e){S(i,o,t,a,s,"throw",e)}a(void 0)}))}}function Z(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function P(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{},o=Object.keys(r);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),o.forEach((function(n){Z(e,n,r[n])}))}return e}var A=(0,s.$j)((function(e){return{user:e.user}}))((function(e){var n,r=e.open,o=e.handleClose,s=e.loading,c=e.user,u=e.idUsuarioConsultar,p=(0,a.useState)([]),m=p[0],y=(p[1],(0,a.useState)("")),k=(y[0],y[2],(0,a.useState)(0)),C=k[0],N=k[1],S=(0,a.useRef)(null),A=(0,a.useState)({}),E=A[0],O=A[1],I=(0,a.useState)(!1),U=I[0],T=I[1],V=(0,a.useState)({usuarios:{leer:!0,escribir:!0,modificar:!0,eliminar:!0},dashboard:{leer:!0}}),D=V[0],F=V[1],z=function(){var e=_(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,T(!0),e.next=4,(0,d.j0)("/api/admin/modificar/"+E._id,P({},E,{permisos:D}));case 4:e.sent.ok?(T(!1),o()):T(!1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return(0,a.useEffect)(_(t().mark((function e(){var n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!u){e.next=15;break}return e.prev=1,T(!0),e.next=5,(0,d.A_)("/api/admin/leer/"+u);case 5:n=e.sent,O(n.data.user),F(n.data.user.permisos),T(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),console.log(e.t0),o();case 15:case"end":return e.stop()}}),e,null,[[1,11]])}))),[u]),(0,i.jsx)(f.Z,{open:r,handleClose:o,loading:s||U,handleSubmit:z,title:"Editar Usuario",height:500,width:800,children:(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)(b.Z,{value:C,onChange:function(e,n){N(n)},indicatorColor:"primary",children:[(0,i.jsx)(x.Z,{label:"Detalles",value:0}),(0,i.jsx)(x.Z,{label:"Permisos",value:1})]}),0===C?(0,i.jsx)("form",{ref:S,className:"jsx-".concat(w.__hash),children:(0,i.jsxs)(v.Z,{container:!0,children:[(0,i.jsxs)(v.Z,{xs:6,children:[(0,i.jsx)(g.oi,{label:" Nombres (*)",type:"text",placeholder:"Ingrese su primer nombre",name:"nombres",error:m.includes("primerNombre"),defaultValue:null===E||void 0===E?void 0:E.nombres,disabled:s}),(0,i.jsx)(g.oi,{label:"Apellidos (*)",type:"text",placeholder:"Ingrese su primer apellido",name:"apellidos",error:m.includes("primerApellido"),defaultValue:null===E||void 0===E?void 0:E.apellidos,disabled:s}),(0,i.jsx)("div",{style:{display:"flex"},className:"jsx-".concat(w.__hash),children:(0,i.jsx)(g.oi,{label:"C\xe9dula (*)",type:"text",placeholder:"Ingrese su c\xe9dula",name:"identificador",error:m.includes("identificador"),defaultValue:null===E||void 0===E||null===(n=E.identificacion)||void 0===n?void 0:n.identificador,disabled:s})}),(0,i.jsx)(g.oi,{label:"Correo Electr\xf3nico(*)",type:"text",placeholder:"Ingrese su correo electr\xf3nico",name:"email",error:m.includes("email"),defaultValue:null===E||void 0===E?void 0:E.email,disabled:s})]}),(0,i.jsx)(v.Z,{xs:6,children:(0,i.jsx)(g.oi,{label:"Creado por (*)",type:"text",placeholder:"Ingrese su contrase\xf1a",name:"creadoPor",defaultValue:"".concat(null===c||void 0===c?void 0:c.primerNombre," ").concat(null===c||void 0===c?void 0:c.segundoNombre," ").concat(null===c||void 0===c?void 0:c.primerApellido," ").concat(null===c||void 0===c?void 0:c.segundoApellido),disabled:!0})})]})}):(0,i.jsx)(j,{valoresPermisos:D,handleChangePermisos:function(e,n,r){F(P({},D,Z({},e,P({},D[e],Z({},n,r)))))}}),(0,i.jsx)(h.default,{id:w.__hash,children:w})]})})}));function E(e){var n=e.open,r=e.handleClose,o=e.loading,t=e.handleSubmit,a=e.datosEliminar;return(0,i.jsx)(f.Z,{open:n,handleClose:r,loading:o,handleSubmit:t,title:"Eliminar Usuario",height:120,width:800,children:(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)("h2",{className:"jsx-".concat(w.__hash),children:["\xbfEst\xe1 seguro que desea eliminar al usuario ",null===a||void 0===a?void 0:a.nombres," ",null===a||void 0===a?void 0:a.apellidos,"?"]}),(0,i.jsx)(h.default,{id:w.__hash,children:w})]})})}function O(e,n,r,o,t,i,a){try{var s=e[i](a),l=s.value}catch(c){return void r(c)}s.done?n(l):Promise.resolve(l).then(o,t)}function I(e){return function(){var n=this,r=arguments;return new Promise((function(o,t){var i=e.apply(n,r);function a(e){O(i,o,t,a,s,"next",e)}function s(e){O(i,o,t,a,s,"throw",e)}a(void 0)}))}}var U=(0,s.$j)((function(e){return{userType:e.userType,user:e.user}}))((function(e){var n=e.user,r=(0,a.useState)(!1),o=r[0],s=r[1],h=(0,a.useState)([]),f=h[0],b=h[1],x=(0,a.useState)(!1),v=x[0],g=x[1],j=(0,a.useState)(!1),y=j[0],w=j[1],k=(0,a.useState)(!1),C=k[0],S=k[1],_=(0,a.useState)(!1),Z=_[0],P=_[1],O=(0,a.useState)(null),U=O[0],T=O[1],V=(0,a.useState)({}),D=V[0],F=V[1];(0,a.useEffect)((function(){z()}),[]);var z=function(){var e=I(t().mark((function e(){var n,r,o,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,s(!0),e.next=4,(0,d.A_)("/api/admin/leer");case 4:(n=e.sent).ok?(a=[],null===(r=n.data)||void 0===r||null===(o=r.users)||void 0===o||o.forEach((function(e){a.push([e.nombres,e.apellido,e.createdAt,e.lastConnection,e.createdBy,(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(u.Z,{onClick:function(){$(e._id)},className:"icon-action",title:"Editar Usuario"}),(0,i.jsx)(p.Z,{onClick:function(){B(e)},className:"icon-action",title:"Elimiar Usuario"})]})])})),b(a),s(!1)):(s(!1),b([])),e.next=13;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),s(!1),b([]);case 13:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}(),$=function(e){T(e),S(!0)},B=function(e){F(e),P(!0)},L=function(){g(!1),S(!1),P(!1)},R=function(){var e=I(t().mark((function e(r,o){var i;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(r),i={nombres:"".concat(r.get("primerNombre")," ").concat(r.get("segundoNombre")),apellidos:"".concat(r.get("primerApellido")," ").concat(r.get("segundoApellido")),rol:"administrador",identificador:r.get("identificador"),email:r.get("email"),password:r.get("password"),createdBy:"".concat(n.primerNombre," ").concat(n.segundoNombre," ").concat(n.primerApellido," ").concat(n.segundoApellido),identificadorTipo:"V",permisos:o},w(!0),e.prev=4,e.next=7,(0,d.j0)("/api/admin/signup",i);case 7:e.sent.ok?(w(!1),g(!1),z()):setLosetLoadingModalading(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(4),w(!1),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[4,11]])})));return function(n,r){return e.apply(this,arguments)}}(),X=function(){var e=I(t().mark((function e(){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,w(!0),e.next=4,(0,d.j0)("/api/admin/eliminar/"+D._id,D);case 4:e.sent.ok?(w(!1),P(!1),z()):w(!1),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),w(!1);case 12:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(l.Z,{children:[(0,i.jsxs)("div",{className:"header-title-container",children:[(0,i.jsx)("h2",{className:"title-section",children:"Gresti\xf3n de Usuarios"}),(0,i.jsx)(c.Z,{onClick:function(){g(!0)},className:"small-button blue-background add-button",variant:"contained",children:"A\xf1adir"})]}),(0,i.jsx)("div",{style:{height:"calc(100vh - 230px)",marginTop:10},children:(0,i.jsx)(m.Z,{headers:["Nombre","Apellido","Fecha Creado","\xdaltima Sesi\xf3n","Creado por","Acci\xf3n"],data:f,loading:o,paginate:!0})})]}),(0,i.jsx)(N,{open:v,handleClose:L,loading:y,handleSubmit:R}),(0,i.jsx)(A,{open:C,handleClose:L,loading:y,idUsuarioConsultar:U}),(0,i.jsx)(E,{open:Z,handleClose:L,loading:y,datosEliminar:D,handleSubmit:X})]})}))}},function(e){e.O(0,[546,426,941,774,888,179],(function(){return n=7899,e(e.s=n);var n}));var n=e.O();_N_E=n}]);