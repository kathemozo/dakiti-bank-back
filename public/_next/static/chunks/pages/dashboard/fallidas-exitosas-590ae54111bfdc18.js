(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{329:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/fallidas-exitosas",function(){return n(566)}])},566:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Y}});var a=n(4051),r=n.n(a),o=n(5893),i=n(7294),c=n(2351),s=n(3369),u=n(7590),l=n(649),d=n(381),f=n.n(d),h=n(1242),m=n(282),g=n(9306),x=n.n(g);function p(e,t,n,a,r,o,i){try{var c=e[o](i),s=c.value}catch(u){return void n(u)}c.done?t(s):Promise.resolve(s).then(a,r)}function b(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){p(o,a,r,i,c,"next",e)}function c(e){p(o,a,r,i,c,"throw",e)}i(void 0)}))}}function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=null;function Y(e){e=null!==e?e:function(e){throw e}(new TypeError("Cannot destructure undefined"));var t=(0,i.useState)({fechaFrom:f()().format("MM/DD/YYYY"),fechaTo:f()().format("MM/DD/YYYY")}),n=t[0],a=t[1],d=(0,i.useState)([]),g=d[0],p=d[1],Y=(0,i.useState)(!1),y=Y[0],j=Y[1],E=(0,i.useState)([]),k=E[0],D=E[1],P=(0,i.useState)([]),C=P[0],O=P[1],_=function(){var e=b(r().mark((function e(){var t,a,o,i,c,s,u,d;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,p([]),D([]),O([]),j(!0),e.next=8,(0,l.j0)("/api/admin/reporte-trasacciones",n);case 8:if((o=e.sent).ok){e.next=12;break}return j(!1),e.abrupt("return");case 12:i=0,c=0,null===(t=o.data)||void 0===t||t.transacciones.forEach((function(e){"exitosa"===e.estatus?c+=1:i+=1})),[],u=i/(s=i+c)*100,d=c/s*100,D([{label:["Transacciones"],data:[i,c],backgroundColor:["#BA2029","#074EE8"],borderColor:[],borderWidth:1}]),O([{label:["Transacciones"],data:[u,d],backgroundColor:["#BA2029","#074EE8"],borderColor:[],borderWidth:1}]),p(null===(a=o.data)||void 0===a?void 0:a.transacciones.map((function(e){return[f()(e.fecha).format("DD/MM/YYYY HH:mm"),e.usuario.nombre?e.usuario.nombre+" "+e.usuario.apellido:"Compra con tarjeta",e.estatus,e.origen||"Tajreta",e.destino||"Otro banco"]}))),j(!1),e.next=29;break;case 25:e.prev=25,e.t0=e.catch(0),j(!1),console.log(e.t0);case 29:case"end":return e.stop()}}),e,null,[[0,25]])})));return function(){return e.apply(this,arguments)}}();function W(){return(W=b(r().mark((function e(t){var n,a,o,i,c,s,u,l;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(e.prev=0,(n=new w("landscape")).text(240,15,f()().format("DD/MM/YYYY - hh:mm")),n.setFontSize(40),n.text(75,15,"Dakiti Administradores",{align:"center"}),n.setFontSize(26),n.text(150,47,"Reporte de transacciones fallidas/exitosas",{align:"center"}),n.setFontSize(14),n.text(25,60,"Fecha",{align:"center",maxWidth:60}),n.text(85,60,"Nombre Cliente",{align:"center",maxWidth:85}),n.text(130,60,"Estatus",{align:"center",maxWidth:85}),n.text(185,60,"Origen",{align:"center",maxWidth:85}),n.text(245,60,"Destino",{align:"center",maxWidth:85}),a=80,o=20,i=0,0,c=0;c<g.length;c++)n.text(25,a+o*(c-i),"".concat(g[c][0]),{align:"center",maxWidth:85}),n.text(85,a+o*(c-i),"".concat(g[c][1]),{align:"center",maxWidth:85}),n.text(130,a+o*(c-i),"".concat(g[c][2]),{align:"center",maxWidth:85}),n.text(185,a+o*(c-i),"".concat(g[c][3]),{align:"center",maxWidth:85}),n.text(245,a+o*(c-i),"".concat(g[c][4]),{align:"center",maxWidth:85}),a+o*(c-i)>180&&(n.addPage(),a=5,i=c),a+o*(c-i);return n.addPage(),s=document.getElementById("nodo-graficas"),e.next=22,x().toPng(s);case 22:u=e.sent,(l=new Image).src=u,n.setFontSize(40),n.text(60,15,"Gr\xe1ficas resumen",{align:"center"}),n.addImage(l,"JPEG",10,30),n.save("Reporte de transacciones fallidas/exitosas_".concat(f()().format("DD/MM/YYYY-hh:mm"),".pdf")),e.next=34;break;case 31:e.prev=31,e.t0=e.catch(0),console.log(e.t0);case 34:case"end":return e.stop()}}),e,null,[[0,31]])})))).apply(this,arguments)}return(0,o.jsxs)(c.Z,{children:[(0,o.jsx)(s.Z,{filtersForm:n,handleFormChange:function(e){var t=e.target.name,r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){v(e,t,n[t])}))}return e}({},n);console.log(e.target),r[t]=e.target.value,a(r)},submitConsulta:_}),(0,o.jsx)("div",{style:{textAlign:"right",marginTop:10},children:(0,o.jsx)(m.Z,{className:"medium-button blue-background",onClick:function(e){return W.apply(this,arguments)},children:"Descargar PDF"})}),(0,o.jsx)("div",{style:{height:"calc(100vh - 230px)",marginTop:10},children:(0,o.jsx)(u.Z,{headers:["Fecha","Nombre Cliente","Estatus","Origen(cuenta o tarjeta)","Destino"],data:g,loading:y,paginate:!0})}),(0,o.jsx)("div",{style:{height:"calc(100vh - 230px)",marginTop:10},children:(0,o.jsx)(h.Z,{labels:["Fallidas","Exitosas"],datasets:k,datasetsPie:C})})]})}n.e(323).then(n.t.bind(n,2617,23)).then((function(e){w=e.default}))}},function(e){e.O(0,[885,570,778,813,426,254,306,617,774,888,179],(function(){return t=329,e(e.s=t);var t}));var t=e.O();_N_E=t}]);